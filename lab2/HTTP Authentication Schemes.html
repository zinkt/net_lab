<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252"><title>HTTP Authentication Schemes</title>
 <style type="text/css">
   .ulDocsTable {
      width:95%;
      background-color: #CD3201;
      color: #ffffff;
      font-size : 100%;
      }
   .ulDocsTable caption {
      text-align: left;
      color: black;
      font-weight: bold;
      }
   .ulDocsTable th {
      text-align: center;
      }
   .ulDocsTable td {
      background-color: #fcfccc; color: black;
      }
  </style> <script language="JavaScript">
  <!-- Begin hiding from older browsers

  //End hiding-->
  </script> </head> <body vlink="800080" text="000000" link="0000FF" bgcolor="#DCDCDC" alink="FF0000"> <div align="center"></div> 
<center>
  <table width="741" cellspacing="0" cellpadding="0" border="0">
    <tbody><tr>
      <td valign="top" background="HTTP%20Authentication%20Schemes_files/leftBG.jpg"><img src="HTTP%20Authentication%20Schemes_files/topLeftCorner.jpg" width="11" height="163"></td>
      <td valign="top" bgcolor="#FFFFFF">
        <table width="100%" cellspacing="0" cellpadding="0" border="0" background="HTTP%20Authentication%20Schemes_files/frontierHeaderBG.jpg">
          <tbody><tr background="HTTP%20Authentication%20Schemes_files/frontierHeaderBG.jpg"> 
            <td><img src="HTTP%20Authentication%20Schemes_files/frontierHeader.jpg" usemap="#Map" width="718" height="163" border="0"></td>
          </tr>
        </tbody></table>
        <map name="Map"><area shape="rect" coords="9,98,440,163" href="http://frontier.userland.com/"><area shape="rect" coords="3,12,135,33" href="http://www.userland.com/"></map> 
        <table width="718" cellspacing="0" cellpadding="0" border="0" bgcolor="#FFFFFF">
          <tbody><tr>
            <td width="100%" valign="top">
              <table cellspacing="0" cellpadding="0" border="0">
                <tbody><tr>
                  <td><i>&nbsp;&nbsp;&nbsp;</i></td>
                  <td><i><font size="-1">Web CMS, object database, scripting, tools, HTTP server, Windows &amp; Mac.</font></i> </td>
                </tr>
              </tbody></table>
              
              <br>
            </td>
            <td width="212" valign="top" align="right"><img src="HTTP%20Authentication%20Schemes_files/frontierCactusBase.jpg" width="212" height="12"></td>
          </tr>
        </tbody></table>
        <table width="100%" cellspacing="0" cellpadding="0" border="0">
          <tbody><tr align="right"> 
            <td><img src="HTTP%20Authentication%20Schemes_files/shadow.jpg" width="718" height="14"></td>
          </tr>
        </tbody></table>
        <table width="100%" cellspacing="0" cellpadding="0" border="0">
          <tbody><tr> 
            <td width="100" valign="top"> 
              <table width="100" cellspacing="0" cellpadding="7" border="0">
                <tbody><tr align="right"> 
                  <td><font size="-1"><a href="http://frontier.userland.com/" class="navigatorLink">Home</a><p>
<a href="http://manila.userland.com/" class="navigatorLink">UserLand Manila</a></p><p>
<a href="http://frontierkernel.org/" class="navigatorLink">Open Source Site</a></p><p>
<a href="http://frontier.userland.com/discuss/" class="navigatorLink">Discussion Forum</a></p><p>
<a href="http://frontier.userland.com/directory/7708/usersGuideTableOfContents" class="navigatorLink">User's Guide</a></p><p>
<a href="http://manila.userland.com/support" class="navigatorLink">Support</a></p><p>
<a href="http://frontier.userland.com/directory/7708" class="navigatorLink">Directory</a></p></font><p><font size="-1">
<a href="http://frontier.userland.com/searchPage" class="navigatorLink">Search</a></font><br>
                    <br><br>
                    <table cellspacing="0" cellpadding="0" border="0" bgcolor="#000000">
	<tbody><tr bgcolor="black">
		<td>
			<table cellspacing="1" cellpadding="3" border="0" bgcolor="black">
				<tbody><tr>
					<td valign="top" bgcolor="black" align="right">
						<font size="-1" color="FFFFF0"><b>Members</b></font>
						</td>
					</tr>
				<tr>
					<td valign="top" bgcolor="ivory" align="right">
						<font size="-1">
							<a href="http://login.userland.com/signUp">Join Now</a><br>
							</font>
						</td>
					</tr>
				<tr>
					<td valign="top" bgcolor="ivory" align="right">
						<font size="-1">
							<a href="http://login.userland.com/">Login</a><br>
							</font>
						</td>
					</tr>
				</tbody></table>
			</td>
		</tr>
	</tbody></table>
 
                    </p><p> 
                  </p></td>
                </tr>
              </tbody></table>
            </td>
            <td width="1" bgcolor="#DDDDDD"><img src="HTTP%20Authentication%20Schemes_files/shim.gif" width="1" height="1"> 
            </td>
            <td width="100%" valign="top"> 
              <table width="100%" cellspacing="0" cellpadding="7" border="0">
                <tbody><tr> 
                  <td>
                    <p></p>
                    <h2>HTTP Authentication Schemes</h2>
                    <p></p><p><b><a name="mainHead1">Introduction</a></b><br>
</p><p>This document describes two schemes for the authentication of 
HTTP clients. Familiarity with the basic structure of HTTP requests, 
responses, status codes, and message headers is assumed.<br>
</p><p><b><a name="mainHead2">HTTP Access Authentication Framework</a></b><br>
</p><p>The HTTP protocol (<a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">RFC 2616</a>)
 defines a simple framework for access authentication schemes. The 
assumption is that a certain group of pages -- usually refered to as a 
protected realm or just  a realm -- should only be accessible to certain
 people who are able to provide credentials if challenged by the server.<br>
</p><p>If an HTTP client, e.g. a web browser, requests a page that is 
part of a protected realm, the server responds with a 401 Unauthorized 
status code and includes a WWW-Authenticate header field in his 
response. This header field must contain at least one authentication 
challenge applicable to the requested page.<br>
</p><p>Next, the client makes another request, this time including an 
Authentication header field which contains the client's credentials 
applicable to the server's authentication challenge.<br>
</p><p>If the server accepts the credentials, it returns the requested 
page. Otherwise, it returns another 401 Unauthorized response to inform 
the client the authentication has failed.<br>
</p><p>The exact contents of the WWW-Authenticate and Authentication 
header fields depend on the authentication scheme being used. As of this
 writing, two authentication schemes are in wide use.<br>
</p><p><b><a name="mainHead3">Basic Access Authentication</a></b><br>
</p><p>The basic authentication scheme assumes that your (the client's) 
credentials consist of a username and a password where the latter is a 
secret known only to you and the server.<br>
</p><p>The server's 401 response contains an authentication challenge 
consisting of the token "Basic" and a name-value pair specifying the 
name of the protected realm. Example:<br>
</p><p></p><blockquote><pre>WWW-Authenticate: Basic realm="Control Panel"</pre></blockquote><br>
<p>Upon receipt of the server's 401 response, your web browser prompts 
you for the username and password associated with that realm. The 
Authentication header of your browser's follow-up request again contains
 the token "Basic" and the base64-encoded concatenation of the username,
 a colon, and the password.<br>
</p><p></p><blockquote><pre>Authorization: Basic QWRtaW46Zm9vYmFy</pre></blockquote><br>
<p>The server base64-decodes the credentials and compares them against 
his username-password database. If it finds a match, you are in.<br>
</p><p>The major drawback of the basic authentication scheme is that it 
is relatively simple for eavesdroppers to spy out your password since it
 is transmitted in plain sight.<br>
</p><p><b><a name="mainHead4">Cryptography to the Rescue!</a></b><br>
</p><p>An alternative authentication scheme known as digest 
authentication remedies this weakness through the use of cryptographic 
hashes, usually the MD5 message digest algorithm defined in <a href="ftp://ftp.isi.edu/in-notes/rfc1321.txt">RFC 1321</a>.<br>
</p><p>MD5 takes an input string of arbitrary length and computes a 
128-bit number from it, i.e. there are 2^128 = 
340,282,366,920,938,463,463,374,607,431,768,211,456 different result 
values. Since MD5 is a one-way function, it is virtually impossible to 
reverse the computation and obtain the input value from the output 
value.<br>
</p><p>An implementation of the MD5 algorithm is part of Frontier 6.1, see <a href="http://docserver.userland.com/string/hashMD5">string.hashMD5</a>.<br>
</p><p>Now, if you just took your username and password, ran them thru 
MD5 as you do with base64 for basic authentication and sent the result 
to the server, a hypothetical eavesdropper could obviously record your 
hashed username and password. When prompted by the server to 
authenticate himself, he could then simply send your hashed password to 
get in. This is called a replay attack.<br>
</p><p><b><a name="mainHead5">Digest Access Authentication</a></b><br>
</p><p>To securely prevent replay attacks, a more sophisticated 
procedure is obviously neccessary: the digest access authentication 
scheme.<br>
</p><p>First, the WWW-Authenticate header of the server's initial 401 
response contains a few more name-value pairs beyond the realm string, 
including a value called a nonce. It is the server's responsibility to 
make sure that every 401 response comes with a unique, previously unused
 nonce value.<br>
</p><p>The Authentication header of your browsers follow-up request 
contains your clear-text username, the nonce value it just received, and
 the so-called digest-request, which it might compute as follows (if it 
were written in UserTalk):<br>
</p><p></p><blockquote><pre>A1 = string.hashMD5 (username + ":" + realm + ":" + password)<br>
<p>A2 = string.hashMD5 (paramTable.method + ":" + paramTable.uri)<br>
</p><p>requestdigest = string.hashMD5 (A1 + ":" + nonce + ":" + A2)</p></pre></blockquote><br>
<p>Since all these input values are either known to the server or are 
part of the request headers, it can do the same computation you did and 
if its computation yields the same request digest, it can be sure that 
you are in posession of the correct password.<br>
</p><p>Further, since the MD5 algorithm is not reversible, hypothetical 
eavesdroppers can't obtain your password from the request digest. Also, 
the server can quite effectively prevent replay attacks by not accpeting
 a nonce value for more than a single authentication request. For the 
next request, the server hands out a different nonce value, so that the 
client has to compute the request digest anew.<br>
</p><p>Actually, what has been described here is a slightly simplified version of "digest" access authentication. <a href="ftp://ftp.isi.edu/in-notes/rfc2617.txt">RFC 2617</a>
 describes additional features, including a method for preventing 
third-parties from manipulating the message body while it's in transit.<br>
</p><p><b><a name="mainHead6">Security Considerations</a></b><br>
</p><p>You should keep in mind that even with digest authentication, all
 data except for your password is transmitted in plain view, fully 
accessible to potential eavesdroppers.<br>
</p><p>There's no way for the client to establish that it's actually 
talking to the server it intends to talk to. There's no mechanism in 
place that allows the server to authenticate itself to the client.<br>
</p><p>For a detailed review of the security properties of digest access authentication, please refer to section 4 of <a href="ftp://ftp.isi.edu/in-notes/rfc2617.txt">RFC 2617</a>.<br>
</p><p>Unfortunately, some browsers are lacking support for digest authentication, see this <a href="http://discuss.userland.com/msgReader$12483">discussion group message</a> and the replies for details.<br>
</p><p><b><a name="mainHead7">Implementation for Frontier</a></b><br>
</p><p>An implementation of the basic and digest authentication scheme 
is provided as part of Frontier 6.1 to protect the new control panel 
website from unauthorized access, see 
mainResponder.controlPanel.["#security"]. The core script is <a href="http://docserver.userland.com/mainResponder/security/httpAuthentication">mainResponder.security.httpAuthentication</a>.<br>
</p><p><b><a name="mainHead8">Pointers</a></b><br>
</p><p><a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">RFC 2616</a> -- Hypertext Transfer Protocol -- HTTP/1.1<br>
</p><p><a href="ftp://ftp.isi.edu/in-notes/rfc2617.txt">RFC 2617</a> -- HTTP Authentication: Basic and Digest Access Authentication<br>
</p><p><a href="ftp://ftp.isi.edu/in-notes/rfc1321.txt">RFC 1321</a> -- The MD5 Message-Digest Algorithm<br>
</p><p><a href="http://docserver.userland.com/mainResponder/security/httpAuthentication">mainResponder.security.httpAuthentication</a> -- Protect a website via basic or digest authentication.<br>
</p><p><a href="http://docserver.userland.com/string/hashMD5">string.hashMD5</a> -- Compute a hash value using the MD5 algorithm.<br>
</p><p><a href="http://frontier.userland.com/discuss/msgReader$2159"><img src="HTTP%20Authentication%20Schemes_files/cowskull.gif" width="22" height="18" border="0"></a>
 </p>
                    <p>
                    </p><p> 
                  </p></td>
                </tr>
              </tbody></table>
            </td>
          </tr>
        </tbody></table>
      </td>
      <td valign="top" background="HTTP%20Authentication%20Schemes_files/rightBG.jpg"><img src="HTTP%20Authentication%20Schemes_files/topRightCorner.jpg" width="12" height="163"></td>
    </tr>
    <tr>
      <td><img src="HTTP%20Authentication%20Schemes_files/bottomLeftCorner.jpg" width="11" height="35"></td>
      <td> 
        <table width="100%" cellspacing="0" cellpadding="0" border="0" background="HTTP%20Authentication%20Schemes_files/tableBaseBG.jpg">
          <tbody><tr> 
            <td><img src="HTTP%20Authentication%20Schemes_files/tableBaseLeft.jpg" width="457" height="35"></td>
            <td align="right"><img src="HTTP%20Authentication%20Schemes_files/tableBaseRight.jpg" width="261" height="35"></td>
          </tr>
        </tbody></table>
      </td>
      <td><img src="HTTP%20Authentication%20Schemes_files/bottomRightBG.jpg" width="12" height="35"></td>
    </tr>
  </tbody></table>
  <img src="HTTP%20Authentication%20Schemes_files/shim.gif" width="1" height="1"> 
  © Copyright 1992-2021 <a href="http://www.userland.com/">UserLand Software, 
  Inc.</a>.<br>
  Last update: Wednesday, October 10, 2001 at 8:24:46 AM Pacific.<br>
  Email: <a href="mailto:webmaster@userland.com"></a><a href="mailto:webmaster@userland.com">webmaster@userland.com</a> <br><br>
<a href="http://www.manilasites.com/" title="Manila is an Internet server application that allows groups of writers, designers and graphics people to manage full-featured, high performance web sites through an easy-to-use browser interface."><img src="HTTP%20Authentication%20Schemes_files/thisIsAManilaSite2.gif" alt="This is a Manila site." width="88" height="31" border="0"></a>
</center>
  
  </body></html>